# 聚合函数
---
1、所有的聚合函数都是放在·django.db.models  
2、聚合函数不能够单独执行，需要放在一些可执行聚合函数的方法下面执行，例如`aggregate`   
3、聚合函数执行完成后，会生成一个字段，字段名为1`filedname+__+聚合函数的名字`。以上生成的新字段名为‘price__avg’。
    
##### 此名字可以自行定义，在查询时给定关键字名称即可
```python
result = book.objects,aggregate(newavg=Avg("price"))
```
        
### aggregate
* aggregate()是QuerySet 的一个终止子句，意思是说，它返回一个包含一些键值对的字典。  键的名称是聚合值的标识符，值是计算出来的聚合值。键的名称是按照字段和聚合函数的名称自动生成出来的 

如果你想要对数据进行分组（GROUP BY）后再聚合的操作，则需要使用annotate来实现   
```python
result = book.objects.aggregate(Avg("price"))
```


##### `aggregate`方法返回的不是querySet对象，而是一个字典，这个字典中的键就是新生成字段的名称‘newavg’


### annotate
* annotate: 给返回的记录添加一个额外的临时字段  
* annotate方法返回结果的不仅仅是含有统计结果的一个字典，而是包含有新增统计字段的查询集(queryset）
* 

```python
>>> q = book.objects.annotate(num_authors=Count('authors'))
>>> q[0].num_authors
2
>>> q[1].num_authors
1
# q是books的queryset, 但是每本书按照作者的数量进行了聚合.
```

### 聚合函数

    Avg
    Count
    Max
    Min
    Sum